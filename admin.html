<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin | Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>@import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css'); body { font-family: 'Pretendard', sans-serif; }</style>
</head>
<body class="bg-slate-100 p-8">
    <div class="max-w-5xl mx-auto">
        <header class="flex justify-between items-center mb-10">
            <h1 class="text-3xl font-black text-slate-900 tracking-tighter">STUDENT STATUS</h1>
            <div class="flex gap-2">
                <button onclick="filterClass('all')" class="px-4 py-2 bg-slate-800 text-white rounded-xl text-sm font-bold">전체</button>
                <button onclick="filterClass('650')" class="px-4 py-2 bg-white text-slate-600 rounded-xl text-sm font-bold border border-slate-200">650반</button>
                <button onclick="filterClass('780')" class="px-4 py-2 bg-white text-slate-600 rounded-xl text-sm font-bold border border-slate-200">780반</button>
            </div>
        </header>

        <div class="bg-white rounded-[2rem] shadow-xl overflow-hidden border border-slate-200">
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="bg-slate-50 border-b border-slate-100">
                        <th class="p-5 text-[10px] font-black text-slate-400 uppercase tracking-widest">Class</th>
                        <th class="p-5 text-[10px] font-black text-slate-400 uppercase tracking-widest">ID (학번)</th>
                        <th class="p-5 text-[10px] font-black text-slate-400 uppercase tracking-widest">Name (이름)</th>
                        <th class="p-5 text-[10px] font-black text-slate-400 uppercase tracking-widest">Progress (Voca)</th>
                        <th class="p-5 text-[10px] font-black text-slate-400 uppercase tracking-widest">Progress (Shadow)</th>
                    </tr>
                </thead>
                <tbody id="student-list">
                    </tbody>
            </table>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { apiKey: "AIzaSyBThrCtBNJuVcfPD3Vm6XvPD7McT5JJsN8", authDomain: "eduthot-fb088.firebaseapp.com", projectId: "eduthot-fb088", storageBucket: "eduthot-fb088.firebasestorage.app", messagingSenderId: "919552710378", appId: "1:919552710378:web:7ba72ea2d195e092f8a993" };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadStudents() {
            const querySnapshot = await getDocs(collection(db, "Winter_Users"));
            const list = document.getElementById('student-list');
            list.innerHTML = '';

            querySnapshot.forEach((doc) => {
                const data = doc.data();
                const row = document.createElement('tr');
                row.className = "hover:bg-slate-50 transition-colors border-b border-slate-50";
                row.setAttribute('data-class', data.userClass);
                
                row.innerHTML = `
                    <td class="p-5 font-bold text-slate-500">${data.userClass}</td>
                    <td class="p-5 font-medium text-slate-400">${data.userId}</td>
                    <td class="p-5 font-black text-slate-900">${data.userName || '미입력'}</td>
                    <td class="p-5"><span class="px-3 py-1 bg-indigo-50 text-indigo-600 rounded-lg text-xs font-black">DAY ${data.passedVocaDays ? data.passedVocaDays.join(', ') : '-'}</span></td>
                    <td class="p-5 text-xs text-slate-400 truncate max-w-[150px]">${data.completed_shadowing ? data.completed_shadowing.join(', ') : '기록 없음'}</td>
                `;
                list.appendChild(row);
            });
        }

        window.filterClass = (cls) => {
            const rows = document.querySelectorAll('#student-list tr');
            rows.forEach(row => {
                if(cls === 'all') row.style.display = '';
                else row.style.display = row.getAttribute('data-class') === cls ? '' : 'none';
            });
        };

        loadStudents();
    </script>
</body>
</html>